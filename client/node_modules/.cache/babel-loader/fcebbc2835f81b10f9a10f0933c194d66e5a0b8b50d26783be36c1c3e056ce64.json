{"ast":null,"code":"/**\n * @file add-text-track-data.js\n */\n'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    'default': obj\n  };\n}\nvar _globalWindow = require('global/window');\nvar _globalWindow2 = _interopRequireDefault(_globalWindow);\nvar _videoJs = require('video.js');\nvar _videoJs2 = _interopRequireDefault(_videoJs);\n\n/**\n * Define properties on a cue for backwards compatability,\n * but warn the user that the way that they are using it\n * is depricated and will be removed at a later date.\n *\n * @param {Cue} cue the cue to add the properties on\n * @private\n */\nvar deprecateOldCue = function deprecateOldCue(cue) {\n  Object.defineProperties(cue.frame, {\n    id: {\n      get: function get() {\n        _videoJs2['default'].log.warn('cue.frame.id is deprecated. Use cue.value.key instead.');\n        return cue.value.key;\n      }\n    },\n    value: {\n      get: function get() {\n        _videoJs2['default'].log.warn('cue.frame.value is deprecated. Use cue.value.data instead.');\n        return cue.value.data;\n      }\n    },\n    privateData: {\n      get: function get() {\n        _videoJs2['default'].log.warn('cue.frame.privateData is deprecated. Use cue.value.data instead.');\n        return cue.value.data;\n      }\n    }\n  });\n};\nvar durationOfVideo = function durationOfVideo(duration) {\n  var dur = undefined;\n  if (isNaN(duration) || Math.abs(duration) === Infinity) {\n    dur = Number.MAX_VALUE;\n  } else {\n    dur = duration;\n  }\n  return dur;\n};\n/**\n * Add text track data to a source handler given the captions and\n * metadata from the buffer.\n *\n * @param {Object} sourceHandler the flash or virtual source buffer\n * @param {Array} captionArray an array of caption data\n * @param {Array} metadataArray an array of meta data\n * @private\n */\nvar addTextTrackData = function addTextTrackData(sourceHandler, captionArray, metadataArray) {\n  var Cue = _globalWindow2['default'].WebKitDataCue || _globalWindow2['default'].VTTCue;\n  if (captionArray) {\n    captionArray.forEach(function (caption) {\n      var track = caption.stream;\n      this.inbandTextTracks_[track].addCue(new Cue(caption.startTime + this.timestampOffset, caption.endTime + this.timestampOffset, caption.text));\n    }, sourceHandler);\n  }\n  if (metadataArray) {\n    (function () {\n      var videoDuration = durationOfVideo(sourceHandler.mediaSource_.duration);\n      metadataArray.forEach(function (metadata) {\n        var time = metadata.cueTime + this.timestampOffset;\n        metadata.frames.forEach(function (frame) {\n          var cue = new Cue(time, time, frame.value || frame.url || frame.data || '');\n          cue.frame = frame;\n          cue.value = frame;\n          deprecateOldCue(cue);\n          this.metadataTrack_.addCue(cue);\n        }, this);\n      }, sourceHandler);\n\n      // Updating the metadeta cues so that\n      // the endTime of each cue is the startTime of the next cue\n      // the endTime of last cue is the duration of the video\n      if (sourceHandler.metadataTrack_ && sourceHandler.metadataTrack_.cues && sourceHandler.metadataTrack_.cues.length) {\n        (function () {\n          var cues = sourceHandler.metadataTrack_.cues;\n          var cuesArray = [];\n\n          // Create a copy of the TextTrackCueList...\n          // ...disregarding cues with a falsey value\n          for (var i = 0; i < cues.length; i++) {\n            if (cues[i]) {\n              cuesArray.push(cues[i]);\n            }\n          }\n\n          // Group cues by their startTime value\n          var cuesGroupedByStartTime = cuesArray.reduce(function (obj, cue) {\n            var timeSlot = obj[cue.startTime] || [];\n            timeSlot.push(cue);\n            obj[cue.startTime] = timeSlot;\n            return obj;\n          }, {});\n\n          // Sort startTimes by ascending order\n          var sortedStartTimes = Object.keys(cuesGroupedByStartTime).sort(function (a, b) {\n            return Number(a) - Number(b);\n          });\n\n          // Map each cue group's endTime to the next group's startTime\n          sortedStartTimes.forEach(function (startTime, idx) {\n            var cueGroup = cuesGroupedByStartTime[startTime];\n            var nextTime = Number(sortedStartTimes[idx + 1]) || videoDuration;\n\n            // Map each cue's endTime the next group's startTime\n            cueGroup.forEach(function (cue) {\n              cue.endTime = nextTime;\n            });\n          });\n        })();\n      }\n    })();\n  }\n};\nexports['default'] = {\n  addTextTrackData: addTextTrackData,\n  durationOfVideo: durationOfVideo\n};\nmodule.exports = exports['default'];","map":{"version":3,"names":["Object","defineProperty","exports","value","_interopRequireDefault","obj","__esModule","_globalWindow","require","_globalWindow2","_videoJs","_videoJs2","deprecateOldCue","cue","defineProperties","frame","id","get","log","warn","key","data","privateData","durationOfVideo","duration","dur","undefined","isNaN","Math","abs","Infinity","Number","MAX_VALUE","addTextTrackData","sourceHandler","captionArray","metadataArray","Cue","WebKitDataCue","VTTCue","forEach","caption","track","stream","inbandTextTracks_","addCue","startTime","timestampOffset","endTime","text","videoDuration","mediaSource_","metadata","time","cueTime","frames","url","metadataTrack_","cues","length","cuesArray","i","push","cuesGroupedByStartTime","reduce","timeSlot","sortedStartTimes","keys","sort","a","b","idx","cueGroup","nextTime","module"],"sources":["C:/Users/J3adl30y/Desktop/videostreaming/client/node_modules/videojs-contrib-media-sources/es5/add-text-track-data.js"],"sourcesContent":["/**\n * @file add-text-track-data.js\n */\n'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _globalWindow = require('global/window');\n\nvar _globalWindow2 = _interopRequireDefault(_globalWindow);\n\nvar _videoJs = require('video.js');\n\nvar _videoJs2 = _interopRequireDefault(_videoJs);\n\n/**\n * Define properties on a cue for backwards compatability,\n * but warn the user that the way that they are using it\n * is depricated and will be removed at a later date.\n *\n * @param {Cue} cue the cue to add the properties on\n * @private\n */\nvar deprecateOldCue = function deprecateOldCue(cue) {\n  Object.defineProperties(cue.frame, {\n    id: {\n      get: function get() {\n        _videoJs2['default'].log.warn('cue.frame.id is deprecated. Use cue.value.key instead.');\n        return cue.value.key;\n      }\n    },\n    value: {\n      get: function get() {\n        _videoJs2['default'].log.warn('cue.frame.value is deprecated. Use cue.value.data instead.');\n        return cue.value.data;\n      }\n    },\n    privateData: {\n      get: function get() {\n        _videoJs2['default'].log.warn('cue.frame.privateData is deprecated. Use cue.value.data instead.');\n        return cue.value.data;\n      }\n    }\n  });\n};\n\nvar durationOfVideo = function durationOfVideo(duration) {\n  var dur = undefined;\n\n  if (isNaN(duration) || Math.abs(duration) === Infinity) {\n    dur = Number.MAX_VALUE;\n  } else {\n    dur = duration;\n  }\n  return dur;\n};\n/**\n * Add text track data to a source handler given the captions and\n * metadata from the buffer.\n *\n * @param {Object} sourceHandler the flash or virtual source buffer\n * @param {Array} captionArray an array of caption data\n * @param {Array} metadataArray an array of meta data\n * @private\n */\nvar addTextTrackData = function addTextTrackData(sourceHandler, captionArray, metadataArray) {\n  var Cue = _globalWindow2['default'].WebKitDataCue || _globalWindow2['default'].VTTCue;\n\n  if (captionArray) {\n    captionArray.forEach(function (caption) {\n      var track = caption.stream;\n\n      this.inbandTextTracks_[track].addCue(new Cue(caption.startTime + this.timestampOffset, caption.endTime + this.timestampOffset, caption.text));\n    }, sourceHandler);\n  }\n\n  if (metadataArray) {\n    (function () {\n      var videoDuration = durationOfVideo(sourceHandler.mediaSource_.duration);\n\n      metadataArray.forEach(function (metadata) {\n        var time = metadata.cueTime + this.timestampOffset;\n\n        metadata.frames.forEach(function (frame) {\n          var cue = new Cue(time, time, frame.value || frame.url || frame.data || '');\n\n          cue.frame = frame;\n          cue.value = frame;\n          deprecateOldCue(cue);\n\n          this.metadataTrack_.addCue(cue);\n        }, this);\n      }, sourceHandler);\n\n      // Updating the metadeta cues so that\n      // the endTime of each cue is the startTime of the next cue\n      // the endTime of last cue is the duration of the video\n      if (sourceHandler.metadataTrack_ && sourceHandler.metadataTrack_.cues && sourceHandler.metadataTrack_.cues.length) {\n        (function () {\n          var cues = sourceHandler.metadataTrack_.cues;\n          var cuesArray = [];\n\n          // Create a copy of the TextTrackCueList...\n          // ...disregarding cues with a falsey value\n          for (var i = 0; i < cues.length; i++) {\n            if (cues[i]) {\n              cuesArray.push(cues[i]);\n            }\n          }\n\n          // Group cues by their startTime value\n          var cuesGroupedByStartTime = cuesArray.reduce(function (obj, cue) {\n            var timeSlot = obj[cue.startTime] || [];\n\n            timeSlot.push(cue);\n            obj[cue.startTime] = timeSlot;\n\n            return obj;\n          }, {});\n\n          // Sort startTimes by ascending order\n          var sortedStartTimes = Object.keys(cuesGroupedByStartTime).sort(function (a, b) {\n            return Number(a) - Number(b);\n          });\n\n          // Map each cue group's endTime to the next group's startTime\n          sortedStartTimes.forEach(function (startTime, idx) {\n            var cueGroup = cuesGroupedByStartTime[startTime];\n            var nextTime = Number(sortedStartTimes[idx + 1]) || videoDuration;\n\n            // Map each cue's endTime the next group's startTime\n            cueGroup.forEach(function (cue) {\n              cue.endTime = nextTime;\n            });\n          });\n        })();\n      }\n    })();\n  }\n};\n\nexports['default'] = {\n  addTextTrackData: addTextTrackData,\n  durationOfVideo: durationOfVideo\n};\nmodule.exports = exports['default'];"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}