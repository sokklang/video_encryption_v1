{"ast":null,"code":"/**\n * @file html-media-source.js\n */\n'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if ('value' in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\nvar _get = function get(_x, _x2, _x3) {\n  var _again = true;\n  _function: while (_again) {\n    var object = _x,\n      property = _x2,\n      receiver = _x3;\n    _again = false;\n    if (object === null) object = Function.prototype;\n    var desc = Object.getOwnPropertyDescriptor(object, property);\n    if (desc === undefined) {\n      var parent = Object.getPrototypeOf(object);\n      if (parent === null) {\n        return undefined;\n      } else {\n        _x = parent;\n        _x2 = property;\n        _x3 = receiver;\n        _again = true;\n        desc = parent = undefined;\n        continue _function;\n      }\n    } else if ('value' in desc) {\n      return desc.value;\n    } else {\n      var getter = desc.get;\n      if (getter === undefined) {\n        return undefined;\n      }\n      return getter.call(receiver);\n    }\n  }\n};\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    'default': obj\n  };\n}\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError('Cannot call a class as a function');\n  }\n}\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== 'function' && superClass !== null) {\n    throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass);\n  }\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\nvar _globalWindow = require('global/window');\nvar _globalWindow2 = _interopRequireDefault(_globalWindow);\nvar _globalDocument = require('global/document');\nvar _globalDocument2 = _interopRequireDefault(_globalDocument);\nvar _videoJs = require('video.js');\nvar _videoJs2 = _interopRequireDefault(_videoJs);\nvar _virtualSourceBuffer = require('./virtual-source-buffer');\nvar _virtualSourceBuffer2 = _interopRequireDefault(_virtualSourceBuffer);\nvar _addTextTrackData = require('./add-text-track-data');\nvar _codecUtils = require('./codec-utils');\n\n/**\n * Our MediaSource implementation in HTML, mimics native\n * MediaSource where/if possible.\n *\n * @link https://developer.mozilla.org/en-US/docs/Web/API/MediaSource\n * @class HtmlMediaSource\n * @extends videojs.EventTarget\n */\n\nvar HtmlMediaSource = function (_videojs$EventTarget) {\n  _inherits(HtmlMediaSource, _videojs$EventTarget);\n  function HtmlMediaSource() {\n    var _this = this;\n    _classCallCheck(this, HtmlMediaSource);\n    _get(Object.getPrototypeOf(HtmlMediaSource.prototype), 'constructor', this).call(this);\n    var property = undefined;\n    this.nativeMediaSource_ = new _globalWindow2['default'].MediaSource();\n    // delegate to the native MediaSource's methods by default\n    for (property in this.nativeMediaSource_) {\n      if (!(property in HtmlMediaSource.prototype) && typeof this.nativeMediaSource_[property] === 'function') {\n        this[property] = this.nativeMediaSource_[property].bind(this.nativeMediaSource_);\n      }\n    }\n\n    // emulate `duration` and `seekable` until seeking can be\n    // handled uniformly for live streams\n    // see https://github.com/w3c/media-source/issues/5\n    this.duration_ = NaN;\n    Object.defineProperty(this, 'duration', {\n      get: function get() {\n        if (this.duration_ === Infinity) {\n          return this.duration_;\n        }\n        return this.nativeMediaSource_.duration;\n      },\n      set: function set(duration) {\n        this.duration_ = duration;\n        if (duration !== Infinity) {\n          this.nativeMediaSource_.duration = duration;\n          return;\n        }\n      }\n    });\n    Object.defineProperty(this, 'seekable', {\n      get: function get() {\n        if (this.duration_ === Infinity) {\n          return _videoJs2['default'].createTimeRanges([[0, this.nativeMediaSource_.duration]]);\n        }\n        return this.nativeMediaSource_.seekable;\n      }\n    });\n    Object.defineProperty(this, 'readyState', {\n      get: function get() {\n        return this.nativeMediaSource_.readyState;\n      }\n    });\n    Object.defineProperty(this, 'activeSourceBuffers', {\n      get: function get() {\n        return this.activeSourceBuffers_;\n      }\n    });\n\n    // the list of virtual and native SourceBuffers created by this\n    // MediaSource\n    this.sourceBuffers = [];\n    this.activeSourceBuffers_ = [];\n\n    /**\n     * update the list of active source buffers based upon various\n     * imformation from HLS and video.js\n     *\n     * @private\n     */\n    this.updateActiveSourceBuffers_ = function () {\n      // Retain the reference but empty the array\n      _this.activeSourceBuffers_.length = 0;\n\n      // If there is only one source buffer, then it will always be active and audio will\n      // be disabled based on the codec of the source buffer\n      if (_this.sourceBuffers.length === 1) {\n        var sourceBuffer = _this.sourceBuffers[0];\n        sourceBuffer.appendAudioInitSegment_ = true;\n        sourceBuffer.audioDisabled_ = !sourceBuffer.audioCodec_;\n        _this.activeSourceBuffers_.push(sourceBuffer);\n        return;\n      }\n\n      // There are 2 source buffers, a combined (possibly video only) source buffer and\n      // and an audio only source buffer.\n      // By default, the audio in the combined virtual source buffer is enabled\n      // and the audio-only source buffer (if it exists) is disabled.\n      var disableCombined = false;\n      var disableAudioOnly = true;\n\n      // TODO: maybe we can store the sourcebuffers on the track objects?\n      // safari may do something like this\n      for (var i = 0; i < _this.player_.audioTracks().length; i++) {\n        var track = _this.player_.audioTracks()[i];\n        if (track.enabled && track.kind !== 'main') {\n          // The enabled track is an alternate audio track so disable the audio in\n          // the combined source buffer and enable the audio-only source buffer.\n          disableCombined = true;\n          disableAudioOnly = false;\n          break;\n        }\n      }\n      _this.sourceBuffers.forEach(function (sourceBuffer) {\n        /* eslinst-disable */\n        // TODO once codecs are required, we can switch to using the codecs to determine\n        //      what stream is the video stream, rather than relying on videoTracks\n        /* eslinst-enable */\n\n        sourceBuffer.appendAudioInitSegment_ = true;\n        if (sourceBuffer.videoCodec_ && sourceBuffer.audioCodec_) {\n          // combined\n          sourceBuffer.audioDisabled_ = disableCombined;\n        } else if (sourceBuffer.videoCodec_ && !sourceBuffer.audioCodec_) {\n          // If the \"combined\" source buffer is video only, then we do not want\n          // disable the audio-only source buffer (this is mostly for demuxed\n          // audio and video hls)\n          sourceBuffer.audioDisabled_ = true;\n          disableAudioOnly = false;\n        } else if (!sourceBuffer.videoCodec_ && sourceBuffer.audioCodec_) {\n          // audio only\n          sourceBuffer.audioDisabled_ = disableAudioOnly;\n          if (disableAudioOnly) {\n            return;\n          }\n        }\n        _this.activeSourceBuffers_.push(sourceBuffer);\n      });\n    };\n    this.onPlayerMediachange_ = function () {\n      _this.sourceBuffers.forEach(function (sourceBuffer) {\n        sourceBuffer.appendAudioInitSegment_ = true;\n      });\n    };\n    this.onHlsReset_ = function () {\n      _this.sourceBuffers.forEach(function (sourceBuffer) {\n        if (sourceBuffer.transmuxer_) {\n          sourceBuffer.transmuxer_.postMessage({\n            action: 'resetCaptions'\n          });\n        }\n      });\n    };\n    this.onHlsSegmentTimeMapping_ = function (event) {\n      _this.sourceBuffers.forEach(function (buffer) {\n        return buffer.timeMapping_ = event.mapping;\n      });\n    };\n\n    // Re-emit MediaSource events on the polyfill\n    ['sourceopen', 'sourceclose', 'sourceended'].forEach(function (eventName) {\n      this.nativeMediaSource_.addEventListener(eventName, this.trigger.bind(this));\n    }, this);\n\n    // capture the associated player when the MediaSource is\n    // successfully attached\n    this.on('sourceopen', function (event) {\n      // Get the player this MediaSource is attached to\n      var video = _globalDocument2['default'].querySelector('[src=\"' + _this.url_ + '\"]');\n      if (!video) {\n        return;\n      }\n      _this.player_ = (0, _videoJs2['default'])(video.parentNode);\n\n      // hls-reset is fired by videojs.Hls on to the tech after the main SegmentLoader\n      // resets its state and flushes the buffer\n      _this.player_.tech_.on('hls-reset', _this.onHlsReset_);\n      // hls-segment-time-mapping is fired by videojs.Hls on to the tech after the main\n      // SegmentLoader inspects an MTS segment and has an accurate stream to display\n      // time mapping\n      _this.player_.tech_.on('hls-segment-time-mapping', _this.onHlsSegmentTimeMapping_);\n      if (_this.player_.audioTracks && _this.player_.audioTracks()) {\n        _this.player_.audioTracks().on('change', _this.updateActiveSourceBuffers_);\n        _this.player_.audioTracks().on('addtrack', _this.updateActiveSourceBuffers_);\n        _this.player_.audioTracks().on('removetrack', _this.updateActiveSourceBuffers_);\n      }\n      _this.player_.on('mediachange', _this.onPlayerMediachange_);\n    });\n    this.on('sourceended', function (event) {\n      var duration = (0, _addTextTrackData.durationOfVideo)(_this.duration);\n      for (var i = 0; i < _this.sourceBuffers.length; i++) {\n        var sourcebuffer = _this.sourceBuffers[i];\n        var cues = sourcebuffer.metadataTrack_ && sourcebuffer.metadataTrack_.cues;\n        if (cues && cues.length) {\n          cues[cues.length - 1].endTime = duration;\n        }\n      }\n    });\n\n    // explicitly terminate any WebWorkers that were created\n    // by SourceHandlers\n    this.on('sourceclose', function (event) {\n      this.sourceBuffers.forEach(function (sourceBuffer) {\n        if (sourceBuffer.transmuxer_) {\n          sourceBuffer.transmuxer_.terminate();\n        }\n      });\n      this.sourceBuffers.length = 0;\n      if (!this.player_) {\n        return;\n      }\n      if (this.player_.audioTracks && this.player_.audioTracks()) {\n        this.player_.audioTracks().off('change', this.updateActiveSourceBuffers_);\n        this.player_.audioTracks().off('addtrack', this.updateActiveSourceBuffers_);\n        this.player_.audioTracks().off('removetrack', this.updateActiveSourceBuffers_);\n      }\n\n      // We can only change this if the player hasn't been disposed of yet\n      // because `off` eventually tries to use the el_ property. If it has\n      // been disposed of, then don't worry about it because there are no\n      // event handlers left to unbind anyway\n      if (this.player_.el_) {\n        this.player_.off('mediachange', this.onPlayerMediachange_);\n        this.player_.tech_.off('hls-reset', this.onHlsReset_);\n        this.player_.tech_.off('hls-segment-time-mapping', this.onHlsSegmentTimeMapping_);\n      }\n    });\n  }\n\n  /**\n   * Add a range that that can now be seeked to.\n   *\n   * @param {Double} start where to start the addition\n   * @param {Double} end where to end the addition\n   * @private\n   */\n\n  _createClass(HtmlMediaSource, [{\n    key: 'addSeekableRange_',\n    value: function addSeekableRange_(start, end) {\n      var error = undefined;\n      if (this.duration !== Infinity) {\n        error = new Error('MediaSource.addSeekableRange() can only be invoked ' + 'when the duration is Infinity');\n        error.name = 'InvalidStateError';\n        error.code = 11;\n        throw error;\n      }\n      if (end > this.nativeMediaSource_.duration || isNaN(this.nativeMediaSource_.duration)) {\n        this.nativeMediaSource_.duration = end;\n      }\n    }\n\n    /**\n     * Add a source buffer to the media source.\n     *\n     * @link https://developer.mozilla.org/en-US/docs/Web/API/MediaSource/addSourceBuffer\n     * @param {String} type the content-type of the content\n     * @return {Object} the created source buffer\n     */\n  }, {\n    key: 'addSourceBuffer',\n    value: function addSourceBuffer(type) {\n      var buffer = undefined;\n      var parsedType = (0, _codecUtils.parseContentType)(type);\n\n      // Create a VirtualSourceBuffer to transmux MPEG-2 transport\n      // stream segments into fragmented MP4s\n      if (/^(video|audio)\\/mp2t$/i.test(parsedType.type)) {\n        var codecs = [];\n        if (parsedType.parameters && parsedType.parameters.codecs) {\n          codecs = parsedType.parameters.codecs.split(',');\n          codecs = (0, _codecUtils.translateLegacyCodecs)(codecs);\n          codecs = codecs.filter(function (codec) {\n            return (0, _codecUtils.isAudioCodec)(codec) || (0, _codecUtils.isVideoCodec)(codec);\n          });\n        }\n        if (codecs.length === 0) {\n          codecs = ['avc1.4d400d', 'mp4a.40.2'];\n        }\n        buffer = new _virtualSourceBuffer2['default'](this, codecs);\n        if (this.sourceBuffers.length !== 0) {\n          // If another VirtualSourceBuffer already exists, then we are creating a\n          // SourceBuffer for an alternate audio track and therefore we know that\n          // the source has both an audio and video track.\n          // That means we should trigger the manual creation of the real\n          // SourceBuffers instead of waiting for the transmuxer to return data\n          this.sourceBuffers[0].createRealSourceBuffers_();\n          buffer.createRealSourceBuffers_();\n\n          // Automatically disable the audio on the first source buffer if\n          // a second source buffer is ever created\n          this.sourceBuffers[0].audioDisabled_ = true;\n        }\n      } else {\n        // delegate to the native implementation\n        buffer = this.nativeMediaSource_.addSourceBuffer(type);\n      }\n      this.sourceBuffers.push(buffer);\n      return buffer;\n    }\n  }]);\n  return HtmlMediaSource;\n}(_videoJs2['default'].EventTarget);\nexports['default'] = HtmlMediaSource;\nmodule.exports = exports['default'];","map":{"version":3,"names":["Object","defineProperty","exports","value","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","Constructor","protoProps","staticProps","prototype","_get","get","_x","_x2","_x3","_again","_function","object","property","receiver","Function","desc","getOwnPropertyDescriptor","undefined","parent","getPrototypeOf","getter","call","_interopRequireDefault","obj","__esModule","_classCallCheck","instance","TypeError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","_globalWindow","require","_globalWindow2","_globalDocument","_globalDocument2","_videoJs","_videoJs2","_virtualSourceBuffer","_virtualSourceBuffer2","_addTextTrackData","_codecUtils","HtmlMediaSource","_videojs$EventTarget","_this","nativeMediaSource_","MediaSource","bind","duration_","NaN","Infinity","duration","set","createTimeRanges","seekable","readyState","activeSourceBuffers_","sourceBuffers","updateActiveSourceBuffers_","sourceBuffer","appendAudioInitSegment_","audioDisabled_","audioCodec_","push","disableCombined","disableAudioOnly","player_","audioTracks","track","enabled","kind","forEach","videoCodec_","onPlayerMediachange_","onHlsReset_","transmuxer_","postMessage","action","onHlsSegmentTimeMapping_","event","buffer","timeMapping_","mapping","eventName","addEventListener","trigger","on","video","querySelector","url_","parentNode","tech_","durationOfVideo","sourcebuffer","cues","metadataTrack_","endTime","terminate","off","el_","addSeekableRange_","start","end","error","Error","name","code","isNaN","addSourceBuffer","type","parsedType","parseContentType","test","codecs","parameters","split","translateLegacyCodecs","filter","codec","isAudioCodec","isVideoCodec","createRealSourceBuffers_","EventTarget","module"],"sources":["C:/Users/J3adl30y/Desktop/videostreaming/client/node_modules/videojs-contrib-media-sources/es5/html-media-source.js"],"sourcesContent":["/**\n * @file html-media-source.js\n */\n'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nvar _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar _globalWindow = require('global/window');\n\nvar _globalWindow2 = _interopRequireDefault(_globalWindow);\n\nvar _globalDocument = require('global/document');\n\nvar _globalDocument2 = _interopRequireDefault(_globalDocument);\n\nvar _videoJs = require('video.js');\n\nvar _videoJs2 = _interopRequireDefault(_videoJs);\n\nvar _virtualSourceBuffer = require('./virtual-source-buffer');\n\nvar _virtualSourceBuffer2 = _interopRequireDefault(_virtualSourceBuffer);\n\nvar _addTextTrackData = require('./add-text-track-data');\n\nvar _codecUtils = require('./codec-utils');\n\n/**\n * Our MediaSource implementation in HTML, mimics native\n * MediaSource where/if possible.\n *\n * @link https://developer.mozilla.org/en-US/docs/Web/API/MediaSource\n * @class HtmlMediaSource\n * @extends videojs.EventTarget\n */\n\nvar HtmlMediaSource = (function (_videojs$EventTarget) {\n  _inherits(HtmlMediaSource, _videojs$EventTarget);\n\n  function HtmlMediaSource() {\n    var _this = this;\n\n    _classCallCheck(this, HtmlMediaSource);\n\n    _get(Object.getPrototypeOf(HtmlMediaSource.prototype), 'constructor', this).call(this);\n    var property = undefined;\n\n    this.nativeMediaSource_ = new _globalWindow2['default'].MediaSource();\n    // delegate to the native MediaSource's methods by default\n    for (property in this.nativeMediaSource_) {\n      if (!(property in HtmlMediaSource.prototype) && typeof this.nativeMediaSource_[property] === 'function') {\n        this[property] = this.nativeMediaSource_[property].bind(this.nativeMediaSource_);\n      }\n    }\n\n    // emulate `duration` and `seekable` until seeking can be\n    // handled uniformly for live streams\n    // see https://github.com/w3c/media-source/issues/5\n    this.duration_ = NaN;\n    Object.defineProperty(this, 'duration', {\n      get: function get() {\n        if (this.duration_ === Infinity) {\n          return this.duration_;\n        }\n        return this.nativeMediaSource_.duration;\n      },\n      set: function set(duration) {\n        this.duration_ = duration;\n        if (duration !== Infinity) {\n          this.nativeMediaSource_.duration = duration;\n          return;\n        }\n      }\n    });\n    Object.defineProperty(this, 'seekable', {\n      get: function get() {\n        if (this.duration_ === Infinity) {\n          return _videoJs2['default'].createTimeRanges([[0, this.nativeMediaSource_.duration]]);\n        }\n        return this.nativeMediaSource_.seekable;\n      }\n    });\n\n    Object.defineProperty(this, 'readyState', {\n      get: function get() {\n        return this.nativeMediaSource_.readyState;\n      }\n    });\n\n    Object.defineProperty(this, 'activeSourceBuffers', {\n      get: function get() {\n        return this.activeSourceBuffers_;\n      }\n    });\n\n    // the list of virtual and native SourceBuffers created by this\n    // MediaSource\n    this.sourceBuffers = [];\n\n    this.activeSourceBuffers_ = [];\n\n    /**\n     * update the list of active source buffers based upon various\n     * imformation from HLS and video.js\n     *\n     * @private\n     */\n    this.updateActiveSourceBuffers_ = function () {\n      // Retain the reference but empty the array\n      _this.activeSourceBuffers_.length = 0;\n\n      // If there is only one source buffer, then it will always be active and audio will\n      // be disabled based on the codec of the source buffer\n      if (_this.sourceBuffers.length === 1) {\n        var sourceBuffer = _this.sourceBuffers[0];\n\n        sourceBuffer.appendAudioInitSegment_ = true;\n        sourceBuffer.audioDisabled_ = !sourceBuffer.audioCodec_;\n        _this.activeSourceBuffers_.push(sourceBuffer);\n        return;\n      }\n\n      // There are 2 source buffers, a combined (possibly video only) source buffer and\n      // and an audio only source buffer.\n      // By default, the audio in the combined virtual source buffer is enabled\n      // and the audio-only source buffer (if it exists) is disabled.\n      var disableCombined = false;\n      var disableAudioOnly = true;\n\n      // TODO: maybe we can store the sourcebuffers on the track objects?\n      // safari may do something like this\n      for (var i = 0; i < _this.player_.audioTracks().length; i++) {\n        var track = _this.player_.audioTracks()[i];\n\n        if (track.enabled && track.kind !== 'main') {\n          // The enabled track is an alternate audio track so disable the audio in\n          // the combined source buffer and enable the audio-only source buffer.\n          disableCombined = true;\n          disableAudioOnly = false;\n          break;\n        }\n      }\n\n      _this.sourceBuffers.forEach(function (sourceBuffer) {\n        /* eslinst-disable */\n        // TODO once codecs are required, we can switch to using the codecs to determine\n        //      what stream is the video stream, rather than relying on videoTracks\n        /* eslinst-enable */\n\n        sourceBuffer.appendAudioInitSegment_ = true;\n\n        if (sourceBuffer.videoCodec_ && sourceBuffer.audioCodec_) {\n          // combined\n          sourceBuffer.audioDisabled_ = disableCombined;\n        } else if (sourceBuffer.videoCodec_ && !sourceBuffer.audioCodec_) {\n          // If the \"combined\" source buffer is video only, then we do not want\n          // disable the audio-only source buffer (this is mostly for demuxed\n          // audio and video hls)\n          sourceBuffer.audioDisabled_ = true;\n          disableAudioOnly = false;\n        } else if (!sourceBuffer.videoCodec_ && sourceBuffer.audioCodec_) {\n          // audio only\n          sourceBuffer.audioDisabled_ = disableAudioOnly;\n          if (disableAudioOnly) {\n            return;\n          }\n        }\n\n        _this.activeSourceBuffers_.push(sourceBuffer);\n      });\n    };\n\n    this.onPlayerMediachange_ = function () {\n      _this.sourceBuffers.forEach(function (sourceBuffer) {\n        sourceBuffer.appendAudioInitSegment_ = true;\n      });\n    };\n\n    this.onHlsReset_ = function () {\n      _this.sourceBuffers.forEach(function (sourceBuffer) {\n        if (sourceBuffer.transmuxer_) {\n          sourceBuffer.transmuxer_.postMessage({ action: 'resetCaptions' });\n        }\n      });\n    };\n\n    this.onHlsSegmentTimeMapping_ = function (event) {\n      _this.sourceBuffers.forEach(function (buffer) {\n        return buffer.timeMapping_ = event.mapping;\n      });\n    };\n\n    // Re-emit MediaSource events on the polyfill\n    ['sourceopen', 'sourceclose', 'sourceended'].forEach(function (eventName) {\n      this.nativeMediaSource_.addEventListener(eventName, this.trigger.bind(this));\n    }, this);\n\n    // capture the associated player when the MediaSource is\n    // successfully attached\n    this.on('sourceopen', function (event) {\n      // Get the player this MediaSource is attached to\n      var video = _globalDocument2['default'].querySelector('[src=\"' + _this.url_ + '\"]');\n\n      if (!video) {\n        return;\n      }\n\n      _this.player_ = (0, _videoJs2['default'])(video.parentNode);\n\n      // hls-reset is fired by videojs.Hls on to the tech after the main SegmentLoader\n      // resets its state and flushes the buffer\n      _this.player_.tech_.on('hls-reset', _this.onHlsReset_);\n      // hls-segment-time-mapping is fired by videojs.Hls on to the tech after the main\n      // SegmentLoader inspects an MTS segment and has an accurate stream to display\n      // time mapping\n      _this.player_.tech_.on('hls-segment-time-mapping', _this.onHlsSegmentTimeMapping_);\n\n      if (_this.player_.audioTracks && _this.player_.audioTracks()) {\n        _this.player_.audioTracks().on('change', _this.updateActiveSourceBuffers_);\n        _this.player_.audioTracks().on('addtrack', _this.updateActiveSourceBuffers_);\n        _this.player_.audioTracks().on('removetrack', _this.updateActiveSourceBuffers_);\n      }\n\n      _this.player_.on('mediachange', _this.onPlayerMediachange_);\n    });\n\n    this.on('sourceended', function (event) {\n      var duration = (0, _addTextTrackData.durationOfVideo)(_this.duration);\n\n      for (var i = 0; i < _this.sourceBuffers.length; i++) {\n        var sourcebuffer = _this.sourceBuffers[i];\n        var cues = sourcebuffer.metadataTrack_ && sourcebuffer.metadataTrack_.cues;\n\n        if (cues && cues.length) {\n          cues[cues.length - 1].endTime = duration;\n        }\n      }\n    });\n\n    // explicitly terminate any WebWorkers that were created\n    // by SourceHandlers\n    this.on('sourceclose', function (event) {\n      this.sourceBuffers.forEach(function (sourceBuffer) {\n        if (sourceBuffer.transmuxer_) {\n          sourceBuffer.transmuxer_.terminate();\n        }\n      });\n\n      this.sourceBuffers.length = 0;\n      if (!this.player_) {\n        return;\n      }\n\n      if (this.player_.audioTracks && this.player_.audioTracks()) {\n        this.player_.audioTracks().off('change', this.updateActiveSourceBuffers_);\n        this.player_.audioTracks().off('addtrack', this.updateActiveSourceBuffers_);\n        this.player_.audioTracks().off('removetrack', this.updateActiveSourceBuffers_);\n      }\n\n      // We can only change this if the player hasn't been disposed of yet\n      // because `off` eventually tries to use the el_ property. If it has\n      // been disposed of, then don't worry about it because there are no\n      // event handlers left to unbind anyway\n      if (this.player_.el_) {\n        this.player_.off('mediachange', this.onPlayerMediachange_);\n        this.player_.tech_.off('hls-reset', this.onHlsReset_);\n        this.player_.tech_.off('hls-segment-time-mapping', this.onHlsSegmentTimeMapping_);\n      }\n    });\n  }\n\n  /**\n   * Add a range that that can now be seeked to.\n   *\n   * @param {Double} start where to start the addition\n   * @param {Double} end where to end the addition\n   * @private\n   */\n\n  _createClass(HtmlMediaSource, [{\n    key: 'addSeekableRange_',\n    value: function addSeekableRange_(start, end) {\n      var error = undefined;\n\n      if (this.duration !== Infinity) {\n        error = new Error('MediaSource.addSeekableRange() can only be invoked ' + 'when the duration is Infinity');\n        error.name = 'InvalidStateError';\n        error.code = 11;\n        throw error;\n      }\n\n      if (end > this.nativeMediaSource_.duration || isNaN(this.nativeMediaSource_.duration)) {\n        this.nativeMediaSource_.duration = end;\n      }\n    }\n\n    /**\n     * Add a source buffer to the media source.\n     *\n     * @link https://developer.mozilla.org/en-US/docs/Web/API/MediaSource/addSourceBuffer\n     * @param {String} type the content-type of the content\n     * @return {Object} the created source buffer\n     */\n  }, {\n    key: 'addSourceBuffer',\n    value: function addSourceBuffer(type) {\n      var buffer = undefined;\n      var parsedType = (0, _codecUtils.parseContentType)(type);\n\n      // Create a VirtualSourceBuffer to transmux MPEG-2 transport\n      // stream segments into fragmented MP4s\n      if (/^(video|audio)\\/mp2t$/i.test(parsedType.type)) {\n        var codecs = [];\n\n        if (parsedType.parameters && parsedType.parameters.codecs) {\n          codecs = parsedType.parameters.codecs.split(',');\n          codecs = (0, _codecUtils.translateLegacyCodecs)(codecs);\n          codecs = codecs.filter(function (codec) {\n            return (0, _codecUtils.isAudioCodec)(codec) || (0, _codecUtils.isVideoCodec)(codec);\n          });\n        }\n\n        if (codecs.length === 0) {\n          codecs = ['avc1.4d400d', 'mp4a.40.2'];\n        }\n\n        buffer = new _virtualSourceBuffer2['default'](this, codecs);\n\n        if (this.sourceBuffers.length !== 0) {\n          // If another VirtualSourceBuffer already exists, then we are creating a\n          // SourceBuffer for an alternate audio track and therefore we know that\n          // the source has both an audio and video track.\n          // That means we should trigger the manual creation of the real\n          // SourceBuffers instead of waiting for the transmuxer to return data\n          this.sourceBuffers[0].createRealSourceBuffers_();\n          buffer.createRealSourceBuffers_();\n\n          // Automatically disable the audio on the first source buffer if\n          // a second source buffer is ever created\n          this.sourceBuffers[0].audioDisabled_ = true;\n        }\n      } else {\n        // delegate to the native implementation\n        buffer = this.nativeMediaSource_.addSourceBuffer(type);\n      }\n\n      this.sourceBuffers.push(buffer);\n      return buffer;\n    }\n  }]);\n\n  return HtmlMediaSource;\n})(_videoJs2['default'].EventTarget);\n\nexports['default'] = HtmlMediaSource;\nmodule.exports = exports['default'];"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}